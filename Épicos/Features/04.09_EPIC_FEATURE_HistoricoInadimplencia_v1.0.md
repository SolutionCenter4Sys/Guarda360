# F-04.09 — Histórico de Inadimplência

**Épico**: EP-04 — Gestão Financeira  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Painel dedicado ao histórico de inadimplência de pensão: meses em atraso, valores não pagos, juros e multa acumulados (se configurados), e linha do tempo visual de pagamentos vs. vencimentos. Principal subsídio para processos de execução de alimentos.

---

## 2. Solução Proposta

Tabela cronológica de todos os meses com status de pagamento (Pago / Pago com Atraso / Não Pago). Cálculo de multa (2%) e juros (1% a.m.) sobre os meses em atraso, se a configuração incluir esses parâmetros. Destaque visual em vermelho para meses inadimplentes. Exportável para relatório jurídico.

---

## 3. Escopo

### O que ENTRA
- Timeline completa de todos os meses desde o início do uso
- Status de cada mês: Pago no prazo / Pago com atraso / Em aberto / Contestado
- Cálculo de dias de atraso por mês
- Cálculo opcional de multa e juros (se configurado)
- Total consolidado de inadimplência
- Filtro por período e status

### O que NÃO ENTRA
- Cálculo de correção monetária (IGPM, INPC) — fase 2
- Execução automática — fase Judicial

---

## 4. Premissas

- Multa e juros são opcionais — dependem da configuração da pensão
- Os valores são informativos para o app (cálculo jurídico exato é responsabilidade do advogado)
- O histórico começa na data de início da configuração de pensão

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-04.09.01 | Frontend | Como responsável, quero ver a timeline de pagamentos com status visual por mês | 3 |
| US-04.09.02 | Frontend | Como responsável, quero ver o total de inadimplência acumulada em destaque | 2 |
| US-04.09.03 | Frontend | Como responsável, quero filtrar por meses em atraso para ver apenas inadimplências | 1 |
| US-04.09.04 | Backend | Endpoint GET /alimony/delinquency/:childId — lista todos os meses com status e dias de atraso | 3 |
| US-04.09.05 | Backend | Cálculo de multa e juros quando configurado (campo na alimony_config) | 3 |
| US-04.09.06 | Backend | Endpoint GET /alimony/delinquency-total/:childId — total acumulado | 2 |

**Esforço Total**: 14 pontos

---

## 6. Critérios de Aceitação

- [ ] Todos os meses desde o início aparecem na timeline
- [ ] Total de inadimplência confere com soma manual dos meses em atraso
- [ ] Cálculo de multa e juros correto para 3+ meses em atraso (validar com planilha)
- [ ] Filtro de "apenas inadimplentes" funciona corretamente

---

## 7. Complexidade Técnica

**Nível**: Baixa-Média | **Pontos**: 14
