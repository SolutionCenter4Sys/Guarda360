# F-01.08 — Integração com Advogados e Profissionais

**Épico**: EP-01 — Identidade & Acesso  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Permite que um responsável vincule seu advogado de família ou profissional (psicólogo, mediador) ao app, concedendo acesso read-only específico por perfil. O advogado acessa relatórios, ocorrências e chat (marcados como relevantes) do cliente diretamente no app.

---

## 2. Solução Proposta

- Responsável convida profissional por email com tipo de perfil (LAWYER / PROFESSIONAL)
- O profissional cria conta com tipo especial — sem acesso a calendário pessoal
- Advogado vê: relatórios jurídicos, ocorrências do cliente, mensagens marcadas como relevantes
- Psicólogo/Mediador vê: apenas o que o responsável liberar explicitamente
- Profissional pode ter múltiplos clientes (responsáveis) na mesma conta

---

## 3. Escopo

### O que ENTRA
- Convite de profissional por email com tipo de perfil
- Conta de profissional com dashboard simplificado (lista de clientes)
- RBAC: advogado vê relatórios + ocorrências + mensagens relevantes (read-only)
- RBAC: psicólogo/mediador vê apenas o que o responsável autorizar
- O responsável pode revogar o acesso a qualquer momento
- Audit log completo de acessos do profissional

### O que NÃO ENTRA
- Portal dedicado para escritórios de advocacia (B2B) — fase 3
- API para integração com sistemas jurídicos — fase 3
- Cobrança diferenciada para conta de advogado — fase 3

---

## 4. Premissas

- Apenas um advogado por caso (por filho) no MVP — fase 3 suporta múltiplos
- O profissional não é notificado de eventos em tempo real — acessa sob demanda
- Cada acesso do profissional é registrado no audit_log com razão

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-01.08.01 | Frontend | Como responsável, quero convidar meu advogado com acesso read-only ao meu caso | 3 |
| US-01.08.02 | Frontend | Como advogado, quero ver lista de clientes e acessar os dados de cada um | 3 |
| US-01.08.03 | Frontend | Como responsável, quero revogar o acesso do meu advogado | 1 |
| US-01.08.04 | Backend | RBAC para perfil LAWYER: acesso read-only a relatórios + ocorrências + msgs relevantes | 5 |
| US-01.08.05 | Backend | RBAC para perfil PROFESSIONAL: acesso configurável pelo responsável | 3 |
| US-01.08.06 | Backend | Endpoint GET /professional/clients — lista clientes do profissional | 2 |
| US-01.08.07 | Backend | Audit log: registrar cada acesso do profissional com timestamp | 2 |

**Esforço Total**: 19 pontos

---

## 6. Critérios de Aceitação

- [ ] Advogado não consegue editar nenhum dado (apenas leitura)
- [ ] Lista de clientes do advogado só mostra responsáveis que o convidaram
- [ ] Revogação de acesso reflete imediatamente (Redis invalidation)
- [ ] Audit log registra 100% dos acessos do profissional

---

## 7. Complexidade Técnica

**Nível**: Média | **Pontos**: 19  
**Riscos**: RBAC para perfil profissional precisa ser testado exaustivamente para não vazar dados
