# F-06.06 — Histórico de Ocorrências por Filho

**Épico**: EP-06 — Ocorrências & Incidentes  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Painel de histórico de todas as ocorrências registradas pelo responsável autenticado, organizadas cronologicamente com filtros por tipo, gravidade e período. Cada ocorrência exibe um card com resumo (tipo, gravidade, data, trecho da narrativa) e permite acessar o detalhe completo com evidências e hash.

---

## 2. Solução Proposta

Lista paginada com cards de ocorrência. Filtros rápidos por tipo e gravidade. Busca por texto na narrativa. Badge de gravidade com cor para identificação visual rápida. Clicar em uma ocorrência abre o detalhe completo com todas as evidências e hash de integridade.

---

## 3. Escopo

### O que ENTRA
- Lista paginada (20 por página) em ordem cronológica reversa
- Filtros: tipo, gravidade, período (data de início e fim)
- Busca por texto na narrativa (ILIKE no PostgreSQL)
- Card: tipo, gravidade (cor), data do fato, data de registro, trecho da narrativa (100 chars), número de evidências
- Tela de detalhe: narrativa completa, evidências, hash de integridade
- Indicador de hash "selado" vs "pendente"

### O que NÃO ENTRA
- Histórico de ocorrências do outro responsável (por design: ocorrências são privadas)
- Edição de qualquer campo — read-only após registro
- Exportação direta de uma ocorrência (vai pelo EP-07)

---

## 4. Premissas

- O histórico mostra apenas ocorrências do responsável autenticado (não do co-guardião)
- Nenhum campo pode ser editado — INSERT-only
- O advogado vê o mesmo histórico do seu cliente (read-only)

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-06.06.01 | Frontend | Como responsável, quero ver meu histórico de ocorrências com cards coloridos por gravidade | 3 |
| US-06.06.02 | Frontend | Como responsável, quero filtrar por tipo, gravidade e período | 3 |
| US-06.06.03 | Frontend | Como responsável, quero buscar ocorrências por texto | 2 |
| US-06.06.04 | Frontend | Como responsável, quero ver o detalhe de uma ocorrência com evidências e hash | 2 |
| US-06.06.05 | Backend | Endpoint GET /incidents?childId=&type=&severity=&from=&to=&q= — lista paginada | 3 |
| US-06.06.06 | Backend | Endpoint GET /incidents/:id — detalhe com evidências | 2 |

**Esforço Total**: 15 pontos

---

## 6. Critérios de Aceitação

- [ ] Lista de 100 ocorrências carregada em < 2 segundos (paginada)
- [ ] Filtros combinados funcionam corretamente
- [ ] Busca por texto funciona para texto parcial na narrativa
- [ ] Detalhe mostra hash de integridade e status (selado/pendente)

---

## 7. Complexidade Técnica

**Nível**: Baixa-Média | **Pontos**: 15
