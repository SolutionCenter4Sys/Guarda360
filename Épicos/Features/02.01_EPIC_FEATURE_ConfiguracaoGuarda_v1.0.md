# F-02.01 — Configuração do Tipo de Guarda

**Épico**: EP-02 — Guarda & Convivência  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Configuração inicial do modelo de guarda após o vínculo entre os responsáveis. Define o tipo legal (compartilhada, unilateral ou visitas) e parâmetros base do calendário de convivência, que serão usados para pré-popular os eventos recorrentes.

---

## 2. Solução Proposta

Assistente de configuração (wizard) ativado logo após o aceite do convite entre os responsáveis. Permite escolher o tipo de guarda e definir o padrão de convivência inicial (ex: alternado semanal, quinzenal, fins de semana alternados). Essa configuração gera automaticamente os eventos recorrentes no calendário.

---

## 3. Escopo

### O que ENTRA
- Seleção do tipo de guarda: Compartilhada / Unilateral / Visitas
- Para guarda compartilhada: definição do padrão (semanal alternado, quinzenal, outro)
- Para guarda unilateral: definição dos dias de visita do não-guardião
- Data de início da contagem (geralmente data do acordo ou sentença)
- Ambos os responsáveis devem confirmar a configuração

### O que NÃO ENTRA
- Upload do documento de guarda (PDF da sentença) — fase 2
- Integração com sistema judicial para validação — fase 3
- Cálculo de dias de guarda por período — fase 2

---

## 4. Premissas

- A configuração pode ser editada futuramente (ex: mudança de acordo)
- Alteração de configuração gera notificação para ambos os responsáveis
- O tipo de guarda influencia regras de negócio em todo o sistema (ex: quem pode registrar check-in)

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-02.01.01 | Frontend | Como responsável, quero selecionar o tipo de guarda no wizard de configuração inicial | 3 |
| US-02.01.02 | Frontend | Como responsável, quero definir o padrão de convivência (alternado semanal, quinzenal) | 3 |
| US-02.01.03 | Frontend | Como responsável, quero confirmar a configuração e ver os eventos gerados no calendário | 2 |
| US-02.01.04 | Backend | Endpoint POST /custody-config — salva configuração e gera eventos recorrentes | 5 |
| US-02.01.05 | Backend | Endpoint PUT /custody-config/:childId — atualiza configuração com histórico | 3 |
| US-02.01.06 | Backend | Notificação para ambos os responsáveis ao alterar configuração | 2 |

**Esforço Total**: 18 pontos

---

## 6. Critérios de Aceitação

- [ ] Após configuração, calendário já mostra os próximos 3 meses de convivência
- [ ] Alteração de configuração exige confirmação de ambos os responsáveis
- [ ] Histórico de configurações anteriores é mantido (imutabilidade parcial)

---

## 7. Complexidade Técnica

**Nível**: Média | **Pontos**: 18  
**Riscos**: Geração de eventos recorrentes com muitos edge cases (feriados, meses com 28/29/30/31 dias)
