# F-07.10 — Assinaturas Digitais em Acordos Pontuais

**Épico**: EP-07 — Relatórios & Exportação Jurídica  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Sistema de assinatura digital simplificada para acordos pontuais entre os responsáveis: ajuste de calendário fora do padrão, autorização de viagem, mudança temporária de endereço, etc. No MVP, a "assinatura" é um aceite digital (confirmação in-app com senha) com registro imutável.

---

## 2. Solução Proposta

MVP (assinatura simples): Um responsável cria o termo de acordo (texto livre + data), o outro é notificado e confirma com sua senha do app. A confirmação gera um registro imutável com timestamp servidor, IPs e hash do conteúdo do acordo. PDF do acordo gerado automaticamente.

Fase Judicial (futuro): integração com assinatura via certificado ICP-Brasil.

---

## 3. Escopo

### O que ENTRA (MVP — assinatura simplificada)
- Criação de termo de acordo (texto livre + título + data de vigência)
- Notificação ao outro responsável
- Confirmação com senha do app (não ICP-Brasil)
- Registro imutável: conteúdo do acordo + IPs dos dois responsáveis + timestamps de criação e assinatura
- Hash SHA-256 do conteúdo do acordo
- PDF do acordo assinado disponível para download
- Histórico de acordos por filho

### O que NÃO ENTRA
- Assinatura ICP-Brasil — fase Judicial
- Recusa formal (apenas aceite no MVP — recusa = ignorar/deixar expirar)
- Acordo com mais de 2 partes — fase 2

---

## 4. Premissas

- A "assinatura" no MVP é o aceite digital com senha — juridicamente é uma confirmação eletrônica, não assinatura digital no sentido técnico
- O acordo fica aberto para assinatura por 7 dias — após isso expira
- Ambos os responsáveis precisam "assinar" para o acordo ser válido no sistema

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-07.10.01 | Frontend | Como responsável, quero criar um termo de acordo com título, texto e vigência | 3 |
| US-07.10.02 | Frontend | Como responsável, quero confirmar o acordo inserindo minha senha | 2 |
| US-07.10.03 | Frontend | Como responsável, quero ver o histórico de acordos assinados | 2 |
| US-07.10.04 | Frontend | Como responsável, quero baixar o PDF do acordo assinado | 1 |
| US-07.10.05 | Backend | Endpoint POST /agreements — cria termo de acordo | 2 |
| US-07.10.06 | Backend | Endpoint POST /agreements/:id/sign — confirma com senha + registra IP + timestamp | 3 |
| US-07.10.07 | Backend | Gerar hash SHA-256 do conteúdo + assinaturas | 2 |
| US-07.10.08 | Backend | Worker: gerar PDF do acordo assinado após ambas as assinaturas | 5 |
| US-07.10.09 | Backend | Job: expirar acordos não assinados após 7 dias | 2 |

**Esforço Total**: 22 pontos

---

## 6. Critérios de Aceitação

- [ ] PDF do acordo gerado em < 30 segundos após segunda assinatura
- [ ] Hash do conteúdo do acordo verificável externamente
- [ ] Registro inclui IPs reais dos dois responsáveis
- [ ] Acordo expirado não pode mais ser assinado

---

## 7. Complexidade Técnica

**Nível**: Média | **Pontos**: 22
