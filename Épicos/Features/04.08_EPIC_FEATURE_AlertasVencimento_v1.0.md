# F-04.08 — Alertas de Vencimento de Pensão

**Épico**: EP-04 — Gestão Financeira  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Sistema de alertas automáticos para vencimento de pensão alimentícia. Notifica o responsável pagador com antecedência configurável (padrão: 3 dias antes) e envia alerta de inadimplência após o vencimento sem pagamento registrado. Beneficiário também é alertado em caso de não pagamento.

---

## 2. Solução Proposta

Job cron diário verifica os vencimentos do período e dispara notificações por push e email. O pagador recebe lembrete antes do vencimento; após o vencimento sem pagamento, ambos recebem alerta de inadimplência. Frequência de reenvio: uma vez por semana enquanto em atraso.

---

## 3. Escopo

### O que ENTRA
- Alerta ao pagador: 3 dias antes do vencimento (push + email)
- Alerta ao pagador: no dia do vencimento (push)
- Alerta de inadimplência: 1 dia após vencimento sem pagamento (push + email para ambos)
- Reenvio semanal enquanto em atraso (limitado a 4 semanas)
- Preferências configuráveis: quantos dias antes alertar (1, 3 ou 7 dias)

### O que NÃO ENTRA
- SMS como canal — fase 2
- Alerta para advogado em caso de inadimplência — fase 2
- Escalation automático para mediação — fase 2

---

## 4. Premissas

- Alertas são enviados às 8h do horário local do usuário
- O reenvio semanal é interrompido quando o pagamento é registrado
- Configurações de alerta são por usuário, não por filho

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-04.08.01 | Frontend | Como responsável, quero configurar quantos dias antes quero ser alertado | 2 |
| US-04.08.02 | Backend | Job cron diário: verificar vencimentos próximos e enviar alertas de antecedência | 3 |
| US-04.08.03 | Backend | Job cron diário: verificar inadimplências e enviar alertas pós-vencimento | 3 |
| US-04.08.04 | Backend | Job cron semanal: reenviar alerta de inadimplência (até 4 semanas) | 2 |
| US-04.08.05 | Backend | Parar reenvio quando pagamento é registrado (cancelamento do job) | 2 |

**Esforço Total**: 12 pontos

---

## 6. Critérios de Aceitação

- [ ] Alerta de 3 dias chega com 72h ± 2h de antecedência do vencimento
- [ ] Alerta de inadimplência chega 24h ± 2h após o vencimento sem pagamento
- [ ] Reenvio para automaticamente quando pagamento é registrado
- [ ] Máximo de 4 reenvios semanais de inadimplência

---

## 7. Complexidade Técnica

**Nível**: Baixa | **Pontos**: 12
