# F-07.11 — Modo Judicial (Dados Congelados e Não Editáveis)

**Épico**: EP-07 — Relatórios & Exportação Jurídica  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Feature Premium que "congela" todos os dados de um filho em um ponto no tempo para uso exclusivo em processo judicial: nenhum dado novo pode ser adicionado ou modificado, audit log completo de todos os acessos, e geração de relatório completo com hash de integridade do conjunto total de dados.

---

## 2. Solução Proposta

O responsável (ou advogado) ativa o "Modo Judicial" para um filho. A partir desse momento, todos os módulos do filho ficam em modo read-only (inclusive para ambos os responsáveis). Um "snapshot" de todos os dados é gerado com hash. O modo pode ser desativado apenas pela própria parte que ativou, com registro do motivo.

---

## 3. Escopo

### O que ENTRA
- Ativação do Modo Judicial por qualquer responsável ou advogado autorizado
- Congelamento imediato: todos os módulos do filho ficam read-only para ambos os responsáveis
- Snapshot: timestamp de ativação + hash do conjunto de dados no momento do congelamento
- Audit log completo de todos os acessos durante o Modo Judicial
- Desativação com registro de motivo e timestamp
- Badge visual "Modo Judicial Ativo" em todo o app
- Relatório final do Modo Judicial (summary de todos os dados congelados)

### O que NÃO ENTRA
- Ativação por ordem judicial direta (integração Vara) — fase 3
- Custódia de dados por terceiro neutro — fase Judicial avançada
- Preservação de dados além do S3 (redundância adicional) — fase Judicial

---

## 4. Premissas

- Modo Judicial é feature Premium — só disponível em plano pago
- Durante o Modo Judicial, nenhum dado novo pode ser inserido ou editado — apenas leitura
- A ativação notifica imediatamente o outro responsável e o advogado cadastrado
- O hash do snapshot é o hash de toda a estrutura de dados do filho (hash of hashes)

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-07.11.01 | Frontend | Como responsável Premium, quero ativar o Modo Judicial com confirmação de senha | 2 |
| US-07.11.02 | Frontend | Como responsável, quero ver badge "Modo Judicial" em todas as telas do filho | 1 |
| US-07.11.03 | Frontend | Como responsável Premium, quero desativar o Modo Judicial com motivo | 2 |
| US-07.11.04 | Backend | Endpoint POST /judicial-mode/:childId/activate — ativa modo e gera snapshot | 5 |
| US-07.11.05 | Backend | Middleware: verificar Modo Judicial antes de qualquer write operation | 5 |
| US-07.11.06 | Backend | Calcular hash do conjunto de dados (hash of hashes de todos os registros) | 5 |
| US-07.11.07 | Backend | Audit log completo de todos os acessos durante o Modo Judicial | 3 |
| US-07.11.08 | Backend | Endpoint POST /judicial-mode/:childId/deactivate — desativa com motivo | 2 |
| US-07.11.09 | Backend | Notificação imediata ao outro responsável e advogado ao ativar | 2 |

**Esforço Total**: 27 pontos

---

## 6. Critérios de Aceitação

- [ ] Após ativação, POST em qualquer endpoint de dados do filho retorna 423 (Locked)
- [ ] Hash do snapshot registrado e disponível via API
- [ ] Audit log registra 100% dos acessos durante o Modo Judicial
- [ ] Notificação chega em < 2 minutos após ativação

---

## 7. Complexidade Técnica

**Nível**: Muito Alta | **Pontos**: 27  
**Riscos**: Middleware de congelamento deve ser aplicado em 100% dos endpoints sem exceção — requer testes exaustivos de integração
