# F-02.02 — Calendário de Convivência Compartilhado

**Épico**: EP-02 — Guarda & Convivência  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Calendário visual interativo que representa o cronograma de convivência entre pai, mãe e filho. Cada período é colorido por responsável. Permite criar eventos recorrentes, feriados, férias e datas especiais. Todos os eventos são imutáveis após o prazo de registro.

---

## 2. Solução Proposta

- Calendário mensal com cores distintas por responsável (azul = pai, rosa = mãe)
- Suporte a eventos recorrentes (quinzenal automático)
- Criação de eventos pontuais (aniversário, feriado, férias)
- Cada evento tem: início, fim, responsável ativo, status e histórico de alterações
- Visualização também em modo semanal e lista

---

## 3. Escopo

### O que ENTRA
- Calendário mensal/semanal/lista
- Criação de eventos recorrentes e pontuais
- Coloração por responsável ativo
- Feriados nacionais pré-carregados
- Configuração de férias escolares (30 dias/ano, divididos igualmente)
- Datas especiais: aniversários, Dia das Mães/Pais
- Exportação iCal (sincronizar com Google Calendar)

### O que NÃO ENTRA
- Integração automática com calendário escolar — fase 2
- Múltiplos filhos no mesmo calendário — fase 2
- Edição retroativa de eventos passados

---

## 4. Premissas

- Responsável ativo no período é quem tem a criança fisicamente
- Eventos passados não podem ser editados (imutabilidade)
- Feriados nacionais são importados via API pública (ou hardcoded no MVP)
- Ambos os responsáveis veem o mesmo calendário em tempo real

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-02.02.01 | Frontend | Como responsável, quero ver o calendário de convivência em modo mensal com cores por responsável | 5 |
| US-02.02.02 | Frontend | Como responsável, quero criar um período de convivência com início, fim e responsável | 3 |
| US-02.02.03 | Frontend | Como responsável, quero visualizar eventos em modo semanal e lista | 3 |
| US-02.02.04 | Frontend | Como responsável, quero ver feriados nacionais marcados no calendário | 2 |
| US-02.02.05 | Frontend | Como responsável, quero exportar o calendário em formato iCal | 2 |
| US-02.02.06 | Backend | Endpoint GET /calendar/{childId}?month=YYYY-MM — retorna todos os eventos do mês | 3 |
| US-02.02.07 | Backend | Endpoint POST /calendar/event — cria evento de convivência | 3 |
| US-02.02.08 | Backend | Endpoint PUT /calendar/event/{id} — edita evento futuro (não retroativo) | 2 |
| US-02.02.09 | Backend | Regra de negócio: eventos passados são read-only | 2 |
| US-02.02.10 | Backend | Endpoint GET /calendar/export/ical/{childId} — gera arquivo .ics | 3 |

**Esforço Total**: 28 pontos

---

## 6. Critérios de Aceitação

- [ ] Calendário carrega em < 2 segundos para 3 meses de eventos
- [ ] Ambos os responsáveis veem o mesmo calendário simultaneamente
- [ ] Eventos passados são visíveis mas não editáveis
- [ ] Feriados nacionais aparecem marcados automaticamente
- [ ] Arquivo iCal é compatível com Google Calendar e Apple Calendar

---

## 7. Complexidade Técnica

**Nível**: Alta  
**Pontos**: 28  
**Riscos**: Lógica de eventos recorrentes pode ser complexa (edge cases com feriados), sincronização em tempo real entre dois responsáveis
