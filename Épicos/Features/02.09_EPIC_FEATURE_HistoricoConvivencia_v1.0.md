# F-02.09 — Visualização do Histórico de Convivência

**Épico**: EP-02 — Guarda & Convivência  
**Agente**: @the-explorer  
**Versão**: 1.0 | **Data**: 2026-02-24

---

## 1. Descrição da Feature

Painel de histórico que consolida todos os registros de convivência passados: visitas cumpridas, ausências, atrasos, cancelamentos e trocas — com estatísticas visuais. Principal insumo para o relatório jurídico de convivência (EP-07).

---

## 2. Solução Proposta

Lista cronológica reversa de todos os eventos passados com filtros por período, tipo e responsável. Cards com resumo estatístico (% de cumprimento, total de ausências, total de atrasos). Cada registro exibe todos os dados imutáveis com timestamp.

---

## 3. Escopo

### O que ENTRA
- Lista paginada de eventos passados com status e registro de cumprimento
- Filtros por período (mês/trimestre/semestre/custom), tipo e responsável
- Estatísticas: % cumprimento, nº ausências, nº atrasos, nº cancelamentos
- Detalhes de cada evento: horário previsto, horário real, delta, observação
- Exportação dos dados brutos para relatório jurídico (via EP-07)

### O que NÃO ENTRA
- Gráficos avançados de analytics — fase 2
- Comparação entre períodos — fase 2
- Export direto em CSV/Excel — fase 2

---

## 4. Premissas

- Dados históricos são sempre imutáveis (não há botão de editar no histórico)
- Histórico disponível desde a data de início do uso do app
- Ambos os responsáveis veem o mesmo histórico (sem filtragem por responsável viewer)

---

## 5. User Stories

| US | Tipo | Descrição | Esforço |
|----|------|-----------|---------|
| US-02.09.01 | Frontend | Como responsável, quero ver a lista de visitas passadas com status e horários reais | 3 |
| US-02.09.02 | Frontend | Como responsável, quero filtrar o histórico por período e tipo de registro | 2 |
| US-02.09.03 | Frontend | Como responsável, quero ver o resumo estatístico (% cumprimento, ausências, atrasos) | 3 |
| US-02.09.04 | Backend | Endpoint GET /calendar/history/:childId?from=&to=&status= — histórico paginado | 3 |
| US-02.09.05 | Backend | Endpoint GET /calendar/stats/:childId?period= — estatísticas de convivência | 3 |

**Esforço Total**: 14 pontos

---

## 6. Critérios de Aceitação

- [ ] Histórico de 12 meses carregado em < 2 segundos
- [ ] Estatísticas calculadas corretamente (validar com dados de teste)
- [ ] Nenhum dado histórico pode ser editado pelo usuário
- [ ] Filtros funcionam corretamente combinados (período + tipo)

---

## 7. Complexidade Técnica

**Nível**: Baixa-Média | **Pontos**: 14
