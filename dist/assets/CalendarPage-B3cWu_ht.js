import{c as $,r as f,j as e,S as pe,n as I,T as fe,C as be,p as Ue,q as _e,s as We,o as E,i as Qe,m as Ye,t as Q,v as Je,d as Ze,l as le,X as A,w as oe,I as ie,R as Ke}from"./index-DduWlyHt.js";import{S as ce,G as Xe}from"./Badge-BwjyIJz_.js";import{s as he,a as ea}from"./subMonths-bNZNUgqi.js";import{C as aa}from"./chart-no-axes-column-CRnerE2m.js";import{B as ge}from"./ban-BXRknzuR.js";import{t as H,f as d,p as v}from"./pt-BR-Cb6bWWUC.js";import{p as u}from"./parseISO-BYvTlcex.js";import{s as sa,e as ra,i as ta}from"./isWithinInterval-9S8XohMa.js";import{D as la}from"./download-Cux2d8XB.js";import{P as L}from"./plus-B51eporo.js";import{i as oa,a as ne,L as Y,b as de}from"./isToday-BwPed4hj.js";import{R as xe}from"./rotate-ccw-UqZB-OuP.js";import{M as ia}from"./map-pin-o5bSKUXy.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=$("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=$("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=$("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=$("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function na(s,c){const n=H(s.start),p=H(s.end);let o=+n>+p;const x=o?+n:+p,m=o?p:n;m.setHours(0,0,0,0);let i=1;const g=[];for(;+m<=x;)g.push(H(m)),m.setDate(m.getDate()+i),m.setHours(0,0,0,0);return o?g.reverse():g}function Z(s){return H(s).getDay()}const me=["CONFIRMADO","CONFIRMADO","CONFIRMADO","FALTA","CONFIRMADO","ATRASO","CANCELADO","CONFIRMADO"],da={"1M":1,"3M":3,"6M":6,"12M":12};function xa(s,c){const n=da[c],p=[];for(let o=1;o<=n;o++){const x=he(new Date,o),m=x.getMonth(),i=x.getFullYear();for(let g=0;g<4;g++){const N=Math.min(g*7+7,28),k=me[(o*4+g)%me.length];p.push({id:`hist-${o}-${g}`,childId:s,type:g%2===0?"VISITA":"CONVIVENCIA",startAt:new Date(i,m,N,8,0).toISOString(),endAt:new Date(i,m,N,18,0).toISOString(),responsibleUserId:"user-2",guardianRole:"GUARDIAN_2",status:k,title:g%2===0?"Visita — João Pereira":"Convivência — João Pereira",isRecurring:!0})}}return p.sort((o,x)=>new Date(x.startAt).getTime()-new Date(o.startAt).getTime())}function ma(s){const c=s.length||1,n=s.filter(m=>m.status==="CONFIRMADO").length,p=s.filter(m=>m.status==="FALTA").length,o=s.filter(m=>m.status==="ATRASO").length,x=s.filter(m=>m.status==="CANCELADO").length;return{total:s.length,confirmado:n,falta:p,atraso:o,cancelado:x,compliance:Math.round(n/c*100)}}function ua(s){const[c,n]=f.useState(!1),[p,o]=f.useState("3M"),[x,m]=f.useState("ALL"),i=f.useMemo(()=>xa(s,p),[s,p]),g=f.useMemo(()=>x==="ALL"?i:x==="FALTA"?i.filter(k=>k.status==="FALTA"||k.status==="CANCELADO"):i.filter(k=>k.type===x),[i,x]),N=f.useMemo(()=>ma(i),[i]);return{showHistoryPanel:c,setShowHistoryPanel:n,period:p,setPeriod:o,typeFilter:x,setTypeFilter:m,filteredHistory:g,stats:N}}const pa={CONFIRMADO:{label:"Confirmado",color:"var(--color-confirmado)",bg:"var(--color-confirmado-bg)",icon:e.jsx(be,{size:13,"aria-hidden":"true"})},PENDENTE:{label:"Pendente",color:"var(--color-pendente)",bg:"var(--color-pendente-bg)",icon:e.jsx(I,{size:13,"aria-hidden":"true"})},FALTA:{label:"Falta",color:"var(--color-cancelado)",bg:"var(--color-cancelado-bg)",icon:e.jsx(fe,{size:13,"aria-hidden":"true"})},CANCELADO:{label:"Cancelado",color:"var(--color-cancelado)",bg:"var(--color-cancelado-bg)",icon:e.jsx(ge,{size:13,"aria-hidden":"true"})},ATRASO:{label:"Com atraso",color:"#D97706",bg:"rgba(217,119,6,0.08)",icon:e.jsx(I,{size:13,"aria-hidden":"true"})}},fa=[{val:"1M",label:"1 mês"},{val:"3M",label:"3 meses"},{val:"6M",label:"6 meses"},{val:"12M",label:"12 meses"}],ba=[{val:"ALL",label:"Todos"},{val:"VISITA",label:"Visitas"},{val:"CONVIVENCIA",label:"Convivência"},{val:"FALTA",label:"Faltas/Cancel."}];function ue({value:s,active:c,label:n,onClick:p}){return e.jsx("button",{onClick:()=>p(s),className:"text-xs font-bold px-3 py-1 rounded-full transition-all",style:{background:c?"var(--color-primary)":"var(--color-border)",color:c?"#fff":"var(--color-text-secondary)"},children:n})}function ha({compliance:s}){const c=s>=75?"var(--color-confirmado)":s>=50?"linear-gradient(90deg, var(--color-pendente), var(--color-confirmado))":"var(--color-cancelado)";return e.jsxs("div",{className:"px-5 py-3",style:{borderBottom:"1px solid var(--color-border)"},children:[e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsx("span",{className:"text-xs font-semibold",style:{color:"var(--color-text-secondary)"},children:"Taxa de cumprimento"}),e.jsxs("span",{className:"text-xs font-extrabold",style:{color:s>=75?"var(--color-confirmado)":s>=50?"var(--color-pendente)":"var(--color-cancelado)"},children:[s,"%"]})]}),e.jsx("div",{className:"h-2.5 rounded-full overflow-hidden",style:{background:"var(--color-border)"},role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`Taxa de cumprimento: ${s}%`,children:e.jsx("div",{className:"h-full rounded-full transition-all duration-700",style:{width:`${s}%`,background:c}})})]})}function ga({evt:s}){const c=pa[s.status]??{label:s.status,color:"var(--color-text-secondary)",bg:"var(--color-border)",icon:null};return e.jsxs("div",{className:"flex items-center gap-4 px-5 py-3",style:{borderLeft:`4px solid ${c.color}`},children:[e.jsxs("div",{className:"min-w-[80px] text-center",children:[e.jsx("p",{className:"text-sm font-extrabold",style:{color:"var(--color-text-primary)"},children:d(u(s.startAt),"dd/MM")}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:d(u(s.startAt),"yyyy")})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-semibold truncate",style:{color:"var(--color-text-primary)"},children:s.title}),e.jsxs("p",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:[s.type==="VISITA"?"Visita presencial":"Convivência"," · ",d(u(s.startAt),"HH:mm")," — ",d(u(s.endAt),"HH:mm")]})]}),e.jsxs("div",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-bold flex-shrink-0",style:{background:c.bg,color:c.color},children:[c.icon,c.label]})]})}function ya({stats:s,events:c,period:n,typeFilter:p,onPeriodChange:o,onTypeChange:x}){const m=[{label:`${s.compliance}% cumprimento`,bg:"rgba(255,255,255,0.2)"},{label:`${s.confirmado} confirmadas`,bg:"rgba(22,163,74,0.25)"},{label:`${s.falta} faltas`,bg:"rgba(220,38,38,0.25)"},{label:`${s.atraso} atrasos`,bg:"rgba(217,119,6,0.25)"}];return e.jsxs("div",{className:"card overflow-hidden fade-in",children:[e.jsxs("div",{className:"px-5 py-4 flex items-center justify-between flex-wrap gap-3",style:{background:"var(--foursys-gradient)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.18)"},"aria-hidden":"true",children:e.jsx(K,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-extrabold text-white text-base",children:"Histórico de Convivência"}),e.jsxs("p",{className:"text-xs",style:{color:"rgba(255,255,255,0.75)"},children:[s.total," registros · Insumo para relatório jurídico"]})]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:m.map(i=>e.jsx("span",{className:"text-xs font-bold px-2.5 py-1 rounded-full text-white",style:{background:i.bg},children:i.label},i.label))})]}),e.jsxs("div",{className:"flex items-center gap-3 px-5 py-3 flex-wrap",style:{borderBottom:"1px solid var(--color-border)",background:"var(--color-surface-alt)"},role:"group","aria-label":"Filtros do histórico",children:[e.jsx(aa,{size:14,style:{color:"var(--color-text-tertiary)"},"aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-semibold",style:{color:"var(--color-text-tertiary)"},children:"Período:"}),fa.map(i=>e.jsx(ue,{value:i.val,active:n===i.val,label:i.label,onClick:o},i.val)),e.jsx("div",{className:"w-px h-4 bg-[var(--color-border)]","aria-hidden":"true"}),e.jsx("span",{className:"text-xs font-semibold",style:{color:"var(--color-text-tertiary)"},children:"Tipo:"}),ba.map(i=>e.jsx(ue,{value:i.val,active:p===i.val,label:i.label,onClick:x},i.val)),e.jsxs("span",{className:"ml-auto text-xs",style:{color:"var(--color-text-tertiary)"},children:[c.length," evento(s)"]})]}),e.jsx(ha,{compliance:s.compliance}),e.jsx("div",{className:"divide-y",style:{"--tw-divide-color":"var(--color-border)"},children:c.length===0?e.jsxs("div",{className:"px-5 py-8 text-center",children:[e.jsx(K,{size:28,className:"mx-auto mb-2",style:{color:"var(--color-text-tertiary)"}}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-tertiary)"},children:"Nenhum registro encontrado para os filtros selecionados."})]}):c.map(i=>e.jsx(ga,{evt:i},i.id))}),e.jsxs("div",{className:"px-5 py-3 flex items-center gap-2",style:{borderTop:"1px solid var(--color-border)",background:"var(--color-surface-alt)"},children:[e.jsx(pe,{size:12,style:{color:"var(--color-primary)",flexShrink:0},"aria-hidden":"true"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:"Dados históricos imutáveis. Este histórico é insumo para geração de relatório jurídico em Relatórios → Convivência."})]})]})}const ye={GUARDIAN_1:{bg:"var(--color-guardian-a-bg)",border:"var(--color-guardian-a)",text:"var(--color-guardian-a)",label:"Guardião A"},GUARDIAN_2:{bg:"var(--color-guardian-b-bg)",border:"var(--color-guardian-b)",text:"var(--color-guardian-b)",label:"Guardião B"},SHARED:{bg:"rgba(124,58,237,0.06)",border:"var(--color-guardian-shared)",text:"var(--color-guardian-shared)",label:"Compartilhado"}},ve=s=>{var c;return s.status==="FALTA"||s.status==="CANCELADO"?"var(--color-cancelado)":s.status==="ATRASO"?"var(--color-atraso)":s.status==="CONFIRMADO"?"var(--color-confirmado)":((c=ye[s.guardianRole])==null?void 0:c.border)??"var(--color-text-tertiary)"};function va({pct:s}){const n=2*Math.PI*28,p=s/100*n,o=s>=75?"var(--color-confirmado)":s>=50?"var(--color-pendente)":"var(--color-cancelado)";return e.jsxs("div",{className:"relative flex items-center justify-center",style:{width:72,height:72},"aria-hidden":"true",children:[e.jsxs("svg",{width:"72",height:"72",viewBox:"0 0 72 72",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:"36",cy:"36",r:28,fill:"none",stroke:"var(--color-border)",strokeWidth:"6"}),e.jsx("circle",{cx:"36",cy:"36",r:28,fill:"none",stroke:o,strokeWidth:"6",strokeDasharray:`${p} ${n}`,strokeLinecap:"round"})]}),e.jsx("div",{className:"absolute text-center",children:e.jsxs("span",{className:"text-sm font-extrabold leading-none",style:{color:o},children:[s,"%"]})})]})}function ja({evt:s,selected:c}){const n=ve(s);return e.jsxs("div",{className:"w-full rounded text-xs font-semibold px-1 truncate leading-5",style:{background:c?"rgba(255,255,255,0.2)":`color-mix(in srgb, ${n} 15%, transparent)`,color:c?"#fff":n,borderLeft:`2px solid ${c?"rgba(255,255,255,0.7)":n}`},"aria-hidden":"true",children:[d(u(s.startAt),"HH:mm")," ",s.title.split("—")[0].trim()]})}function za(){const[s,c]=f.useState(new Date),[n,p]=f.useState(new Date),[o,x]=f.useState(null),[m,i]=f.useState(!1),[g,N]=f.useState(!1),[k,V]=f.useState(!1),[je,B]=f.useState(!1),[Ne,M]=f.useState(!1),[q,G]=f.useState(Ue),[R,X]=f.useState(_e),[ke,ee]=f.useState(We),[j,Ae]=f.useState(E[0].id),[w,we]=f.useState({}),[U,Ce]=f.useState({}),{toast:y}=Qe(),{showHistoryPanel:O,setShowHistoryPanel:De,period:Se,setPeriod:Ee,typeFilter:Te,setTypeFilter:Ie,filteredHistory:Me,stats:Re}=ua(j),z=q.filter(a=>a.status==="PENDENTE").length,Oe=a=>{const r=new Date().toISOString();we(l=>({...l,[a]:r})),y("Check-in registrado com sucesso!","success")},ze=a=>{const r=new Date().toISOString();Ce(l=>({...l,[a]:r})),y("Check-out registrado com sucesso!","success")},Fe=a=>R.filter(r=>{try{return ta(a,{start:u(r.startDate),end:u(r.endDate)})}catch{return!1}}),Pe=()=>{const a=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Guarda360//Calendário//PT-BR","CALSCALE:GREGORIAN","METHOD:PUBLISH"];C.forEach(t=>{const b=u(t.startAt),_=u(t.endAt),P=W=>d(W,"yyyyMMdd'T'HHmmss");a.push("BEGIN:VEVENT",`UID:${t.id}@guarda360`,`DTSTART:${P(b)}`,`DTEND:${P(_)}`,`SUMMARY:${t.title}`,t.location?`LOCATION:${t.location}`:"",`STATUS:${t.status==="CONFIRMADO"?"CONFIRMED":"TENTATIVE"}`,"END:VEVENT").filter(Boolean)}),R.filter(t=>t.childIds.includes(j)).forEach(t=>{a.push("BEGIN:VEVENT",`UID:${t.id}@guarda360-special`,`DTSTART;VALUE=DATE:${t.startDate.replace(/-/g,"")}`,`DTEND;VALUE=DATE:${t.endDate.replace(/-/g,"")}`,`SUMMARY:${t.title}`,t.notes?`DESCRIPTION:${t.notes}`:"","END:VEVENT").filter(Boolean)}),a.push("END:VCALENDAR");const r=new Blob([a.join(`\r
`)],{type:"text/calendar;charset=utf-8"}),l=URL.createObjectURL(r),h=document.createElement("a");h.href=l,h.download="guarda360-calendario.ics",h.click(),URL.revokeObjectURL(l),y("Calendário exportado (.ics)","success")},ae=sa(s),Le=ra(s),He=na({start:ae,end:Le}),$e=Z(ae),Ve=[...Array($e).fill(null),...He],C=Ye.filter(a=>a.childId===j),se=a=>C.filter(r=>{try{return ne(u(r.startAt),a)}catch{return!1}}),F=n?se(n):[],Be=C.length||1,re=C.filter(a=>a.status==="CONFIRMADO").length,qe=C.filter(a=>a.status==="PENDENTE").length,Ge=C.filter(a=>a.status==="FALTA").length,D=Math.round(re/Be*100),S=E.find(a=>a.id===j);return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-4",style:{minHeight:"100%"},children:[e.jsxs("div",{className:"rounded-2xl overflow-hidden",style:{background:"var(--foursys-gradient)",boxShadow:"0 6px 24px rgba(124,58,237,0.28)"},children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 px-5 pt-4 pb-3 flex-wrap",style:{borderBottom:"1px solid rgba(255,255,255,0.12)"},children:[e.jsx("div",{className:"flex items-center gap-2 flex-wrap",role:"tablist","aria-label":"Selecionar filho",children:E.map(a=>{const r=a.id===j;return e.jsxs("button",{role:"tab","aria-selected":r,onClick:()=>Ae(a.id),className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-semibold transition-all",style:{background:r?"rgba(255,255,255,0.22)":"rgba(255,255,255,0.08)",color:"#fff",border:r?"1.5px solid rgba(255,255,255,0.5)":"1.5px solid transparent",backdropFilter:"blur(4px)"},children:[e.jsx("span",{className:"w-6 h-6 rounded-full flex items-center justify-center font-bold text-xs",style:{background:"rgba(255,255,255,0.25)"},"aria-hidden":"true",children:a.fullName.charAt(0)}),a.fullName.split(" ")[0]]},a.id)})}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>V(!0),className:"relative flex items-center gap-2 px-3 py-2 rounded-full text-sm font-bold transition-all",style:{background:"rgba(255,255,255,0.12)",color:"#fff",border:"1.5px solid rgba(255,255,255,0.25)"},"aria-label":"Solicitações de troca",children:[e.jsx(T,{size:14,"aria-hidden":"true"}),"Trocas",z>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 rounded-full text-xs font-bold flex items-center justify-center",style:{background:"var(--color-cancelado)",color:"#fff"},children:z})]}),e.jsxs("button",{onClick:()=>De(a=>!a),className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-bold transition-all",style:{background:O?"rgba(255,255,255,0.28)":"rgba(255,255,255,0.12)",color:"#fff",border:O?"1.5px solid rgba(255,255,255,0.6)":"1.5px solid rgba(255,255,255,0.25)"},"aria-label":"Histórico de convivência","aria-pressed":O,children:[e.jsx(K,{size:14,"aria-hidden":"true"}),e.jsx("span",{className:"hidden sm:inline",children:"Histórico"})]}),e.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-bold transition-all",style:{background:"rgba(255,255,255,0.12)",color:"#fff",border:"1.5px solid rgba(255,255,255,0.25)"},"aria-label":"Datas especiais",children:[e.jsx(Q,{size:14,"aria-hidden":"true"}),e.jsx("span",{className:"hidden sm:inline",children:"Especiais"})]}),e.jsxs("button",{onClick:()=>M(!0),className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-bold transition-all",style:{background:"rgba(255,255,255,0.12)",color:"#fff",border:"1.5px solid rgba(255,255,255,0.25)"},"aria-label":"Configurar recorrência",children:[e.jsx(J,{size:14,"aria-hidden":"true"}),e.jsx("span",{className:"hidden sm:inline",children:"Recorrência"})]}),e.jsxs("button",{onClick:Pe,className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-bold transition-all",style:{background:"rgba(255,255,255,0.12)",color:"#fff",border:"1.5px solid rgba(255,255,255,0.25)"},"aria-label":"Exportar calendário",children:[e.jsx(la,{size:14,"aria-hidden":"true"}),e.jsx("span",{className:"hidden sm:inline",children:"Exportar"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-bold transition-all",style:{background:"rgba(255,255,255,0.18)",color:"#fff",border:"1.5px solid rgba(255,255,255,0.35)",backdropFilter:"blur(4px)"},children:[e.jsx(L,{size:15,"aria-hidden":"true"}),"Novo evento"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between px-5 py-4",children:[e.jsx("button",{onClick:()=>c(a=>he(a,1)),className:"w-9 h-9 rounded-full flex items-center justify-center transition-all",style:{background:"rgba(255,255,255,0.15)",color:"#fff"},"aria-label":"Mês anterior",children:e.jsx(Je,{size:18,"aria-hidden":"true"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-extrabold capitalize text-white tracking-tight",children:d(s,"MMMM",{locale:v})}),e.jsx("p",{className:"text-sm font-semibold",style:{color:"rgba(255,255,255,0.7)"},children:d(s,"yyyy")})]}),e.jsx("button",{onClick:()=>c(a=>ea(a,1)),className:"w-9 h-9 rounded-full flex items-center justify-center transition-all",style:{background:"rgba(255,255,255,0.15)",color:"#fff"},"aria-label":"Próximo mês",children:e.jsx(Ze,{size:18,"aria-hidden":"true"})})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",role:"legend","aria-label":"Legenda de cores",children:[{color:"var(--color-guardian-a)",bg:"var(--color-guardian-a-bg)",label:"Guardião A"},{color:"var(--color-guardian-b)",bg:"var(--color-guardian-b-bg)",label:"Guardião B"},{color:"var(--color-guardian-shared)",bg:"rgba(124,58,237,0.08)",label:"Compartilhado"},{color:"var(--color-confirmado)",bg:"var(--color-confirmado-bg)",label:"Confirmado"},{color:"var(--color-cancelado)",bg:"var(--color-cancelado-bg)",label:"Falta"},{color:"var(--color-atraso)",bg:"var(--color-pendente-bg)",label:"Atraso"}].map(({color:a,bg:r,label:l})=>e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold",style:{background:r,color:a},children:[e.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{background:a},"aria-hidden":"true"}),l]},l))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 items-start",children:[e.jsxs("section",{className:"lg:col-span-2 card overflow-hidden",style:{padding:0},"aria-label":"Calendário de convivência",children:[e.jsx("div",{className:"grid grid-cols-7 text-center",style:{borderBottom:"1px solid var(--color-border)",background:"var(--color-surface-alt)"},role:"row","aria-label":"Dias da semana",children:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"].map((a,r)=>e.jsx("div",{className:"py-2.5 text-xs font-bold uppercase tracking-widest",style:{color:r===0||r===6?"var(--color-cancelado)":"var(--color-text-tertiary)"},children:a},a))}),e.jsx("div",{className:"grid grid-cols-7",role:"grid","aria-label":"Dias do mês",style:{padding:"4px"},children:Ve.map((a,r)=>{if(!a)return e.jsx("div",{role:"gridcell","aria-hidden":"true",style:{minHeight:80,borderRadius:10}},`pad-${r}`);const l=se(a),h=Fe(a),t=oa(a),b=n?ne(a,n):!1,_=Z(a)===0||Z(a)===6,P=l.length>0,W=h.length>0;return e.jsxs("button",{onClick:()=>{p(a),x(null)},role:"gridcell","aria-label":`${d(a,"d")} de ${d(a,"MMMM",{locale:v})}, ${l.length} evento(s)`,"aria-pressed":b,className:"relative flex flex-col p-1.5 transition-all",style:{minHeight:80,borderRadius:10,margin:2,background:b?"var(--foursys-gradient)":t?"rgba(29,78,216,0.07)":"transparent",boxShadow:b?"0 4px 16px rgba(124,58,237,0.3)":void 0,outline:t&&!b?"2px solid var(--color-primary)":void 0,outlineOffset:-2},children:[e.jsx("span",{className:"text-sm font-bold self-end w-7 h-7 flex items-center justify-center rounded-full",style:{color:b?"#fff":t?"var(--color-primary)":_?"var(--color-text-tertiary)":"var(--color-text-primary)",background:t&&!b?"rgba(29,78,216,0.12)":"transparent",fontWeight:t?800:600},children:d(a,"d")}),W&&e.jsx("div",{className:"absolute top-1 left-1.5",children:e.jsx(Q,{size:9,fill:b?"#fff":"#d97706",stroke:"none","aria-hidden":"true"})}),e.jsxs("div",{className:"flex flex-col gap-0.5 mt-0.5 w-full overflow-hidden",children:[l.slice(0,2).map(te=>e.jsx(ja,{evt:te,selected:b},te.id)),l.length>2&&e.jsxs("div",{className:"text-xs px-1 font-semibold",style:{color:b?"rgba(255,255,255,0.7)":"var(--color-text-tertiary)"},children:["+",l.length-2," mais"]}),!P&&t&&e.jsx("div",{className:"text-xs px-1 font-medium",style:{color:"var(--color-primary)"},children:"Hoje"})]})]},a.toISOString())})})]}),e.jsxs("aside",{className:"flex flex-col gap-4","aria-label":"Detalhes do dia selecionado",children:[n&&e.jsxs("div",{className:"card p-4",style:{borderTop:"3px solid var(--color-primary)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest",style:{color:"var(--color-text-tertiary)"},children:d(n,"EEEE",{locale:v})}),e.jsx("p",{className:"text-4xl font-extrabold leading-none mt-0.5",style:{color:"var(--color-text-primary)"},children:d(n,"d")}),e.jsx("p",{className:"text-sm font-semibold capitalize",style:{color:"var(--color-text-tertiary)"},children:d(n,"MMMM yyyy",{locale:v})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:"Eventos"}),e.jsx("p",{className:"text-3xl font-extrabold",style:{color:F.length>0?"var(--color-primary)":"var(--color-text-tertiary)"},children:F.length})]})]}),F.length===0?e.jsxs("div",{className:"rounded-xl p-4 text-center",style:{background:"var(--color-surface-alt)",border:"1px dashed var(--color-border-dark)"},children:[e.jsx(le,{size:24,className:"mx-auto mb-2",style:{color:"var(--color-text-tertiary)"},"aria-hidden":"true"}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-tertiary)"},children:"Nenhum evento"}),e.jsx("button",{onClick:()=>i(!0),className:"mt-2 text-sm font-semibold",style:{color:"var(--color-primary)"},children:"+ Adicionar evento"})]}):e.jsx("div",{className:"space-y-2",children:F.map(a=>{const r=ye[a.guardianRole],l=a.status==="FALTA"||a.status==="CANCELADO",h=ve(a);return e.jsxs("div",{className:"rounded-xl p-3 cursor-pointer transition-all",style:{background:l?"var(--color-cancelado-bg)":r.bg,border:`1px solid ${l?"var(--color-cancelado-border)":r.border}`,borderLeft:`4px solid ${h}`},onClick:()=>x(a),role:"button",tabIndex:0,onKeyDown:t=>{t.key==="Enter"&&x(a)},"aria-label":`${a.title} — ${a.status}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1.5",children:[e.jsx("p",{className:"text-sm font-bold",style:{color:l?"var(--color-cancelado)":r.text},children:a.title}),e.jsx(ce,{status:a.status})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(I,{size:12,style:{color:"var(--color-text-tertiary)"},"aria-hidden":"true"}),e.jsxs("span",{className:"text-timestamp",children:[d(u(a.startAt),"HH:mm")," — ",d(u(a.endAt),"HH:mm")]}),a.isRecurring&&e.jsx(xe,{size:11,style:{color:"var(--color-text-tertiary)"},"aria-hidden":"true"})]}),a.status==="PENDENTE"&&!w[a.id]&&e.jsxs("div",{className:"flex gap-1.5 mt-2.5",children:[e.jsxs("button",{className:"btn-gradient flex-1 text-xs flex items-center justify-center gap-1",style:{minHeight:30},onClick:t=>{t.stopPropagation(),Oe(a.id)},children:[e.jsx(Y,{size:12,"aria-hidden":"true"}),"Check-in"]}),e.jsx("button",{className:"btn-danger text-xs",style:{minHeight:30,flex:"0 0 auto",padding:"0 12px"},onClick:t=>{t.stopPropagation(),y("Falta registrada.","warning")},children:"Falta"})]}),w[a.id]&&!U[a.id]&&e.jsxs("div",{className:"mt-2.5 space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5 p-1.5 rounded-lg",style:{background:"var(--color-confirmado-bg)"},children:[e.jsx(Y,{size:11,style:{color:"var(--color-confirmado)"},"aria-hidden":"true"}),e.jsxs("span",{className:"text-xs font-semibold",style:{color:"var(--color-confirmado)"},children:["Check-in: ",d(u(w[a.id]),"HH:mm")]})]}),e.jsxs("button",{className:"btn-success w-full text-xs flex items-center justify-center gap-1",style:{minHeight:30},onClick:t=>{t.stopPropagation(),ze(a.id)},children:[e.jsx(de,{size:12,"aria-hidden":"true"}),"Check-out"]})]}),w[a.id]&&U[a.id]&&e.jsxs("div",{className:"mt-2.5 space-y-1 p-2 rounded-lg",style:{background:"var(--color-confirmado-bg)"},children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Y,{size:11,style:{color:"var(--color-confirmado)"}}),e.jsxs("span",{className:"text-xs font-semibold",style:{color:"var(--color-confirmado)"},children:["Entrada: ",d(u(w[a.id]),"HH:mm")]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(de,{size:11,style:{color:"var(--color-confirmado)"}}),e.jsxs("span",{className:"text-xs font-semibold",style:{color:"var(--color-confirmado)"},children:["Saída: ",d(u(U[a.id]),"HH:mm")]})]})]}),a.status==="CONFIRMADO"&&!w[a.id]&&e.jsx("button",{className:"btn-success w-full text-xs mt-2 flex items-center justify-center gap-1",style:{minHeight:30},onClick:t=>{t.stopPropagation(),y("Check-out registrado!","success")},children:"Registrar check-out"})]},a.id)})})]}),e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-label uppercase tracking-wide",style:{color:"var(--color-text-tertiary)"},children:["Resumo — ",d(s,"MMMM",{locale:v})]}),S&&e.jsx("p",{className:"text-xs font-semibold mt-0.5",style:{color:"var(--color-text-secondary)"},children:S.fullName.split(" ")[0]})]}),e.jsx(va,{pct:D})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[{label:"Cumpridas",value:re,color:"var(--color-confirmado)",bg:"var(--color-confirmado-bg)",icon:e.jsx(be,{size:14,"aria-hidden":"true"})},{label:"Pendentes",value:qe,color:"var(--color-pendente)",bg:"var(--color-pendente-bg)",icon:e.jsx(I,{size:14,"aria-hidden":"true"})},{label:"Faltas",value:Ge,color:"var(--color-cancelado)",bg:"var(--color-cancelado-bg)",icon:e.jsx(fe,{size:14,"aria-hidden":"true"})}].map(a=>e.jsxs("div",{className:"rounded-xl p-2.5 text-center",style:{background:a.bg},children:[e.jsx("div",{className:"flex justify-center mb-1",style:{color:a.color},children:a.icon}),e.jsx("p",{className:"text-xl font-extrabold leading-none",style:{color:a.color},children:a.value}),e.jsx("p",{className:"text-xs mt-0.5 font-medium",style:{color:a.color},children:a.label})]},a.label))}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsx("span",{className:"text-caption",children:"Cumprimento"}),e.jsxs("span",{className:"text-xs font-bold",style:{color:D>=75?"var(--color-confirmado)":"var(--color-pendente)"},children:[D,"%"]})]}),e.jsx("div",{className:"h-2.5 rounded-full overflow-hidden flex gap-px",style:{background:"var(--color-border)"},role:"progressbar","aria-valuenow":D,"aria-valuemin":0,"aria-valuemax":100,children:e.jsx("div",{className:"h-full rounded-full transition-all duration-700",style:{width:`${D}%`,background:D>=75?"var(--color-confirmado)":"linear-gradient(90deg, var(--color-pendente), var(--color-confirmado))"}})})]}),e.jsxs("div",{className:"mt-4 pt-4 flex items-center gap-2",style:{borderTop:"1px solid var(--color-border)"},children:[e.jsx(pe,{size:13,style:{color:"var(--color-text-tertiary)"},"aria-hidden":"true"}),e.jsx("span",{className:"text-caption",children:(S==null?void 0:S.fullName)??"—"})]})]}),e.jsxs("button",{onClick:()=>i(!0),className:"btn-gradient w-full flex items-center justify-center gap-2",children:[e.jsx(L,{size:16,"aria-hidden":"true"}),"Novo evento"]})]})]}),O&&e.jsx(ya,{stats:Re,events:Me,period:Se,typeFilter:Te,onPeriodChange:Ee,onTypeChange:Ie}),o&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 fade-in",style:{zIndex:"var(--z-modal)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},role:"dialog","aria-modal":"true","aria-label":o.title,children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl overflow-hidden",style:{boxShadow:"0 24px 64px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{className:"p-6 relative",style:{background:"var(--foursys-gradient)"},children:[e.jsx("button",{onClick:()=>x(null),className:"absolute top-4 right-4 w-8 h-8 rounded-full flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},"aria-label":"Fechar",children:e.jsx(A,{size:16,"aria-hidden":"true"})}),e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-bold mb-3",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},children:[e.jsx(le,{size:12,"aria-hidden":"true"}),o.type==="VISITA"?"Visita presencial":"Convivência"]}),e.jsx("h3",{className:"text-xl font-extrabold text-white",children:o.title}),e.jsx("p",{className:"text-sm mt-1",style:{color:"rgba(255,255,255,0.75)"},children:d(u(o.startAt),"EEEE, dd 'de' MMMM",{locale:v})})]}),e.jsxs("div",{className:"p-6 space-y-4",style:{background:"var(--color-surface)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(29,78,216,0.08)",color:"var(--color-primary)"},"aria-hidden":"true",children:e.jsx(I,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:"Horário"}),e.jsxs("p",{className:"text-sm font-semibold",style:{color:"var(--color-text-primary)"},children:[d(u(o.startAt),"HH:mm")," — ",d(u(o.endAt),"HH:mm")]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(29,78,216,0.08)",color:"var(--color-primary)"},"aria-hidden":"true",children:e.jsx(ia,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:"Tipo"}),e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--color-text-primary)"},children:o.type==="VISITA"?"Visita presencial":"Convivência prolongada"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx(ce,{status:o.status}),e.jsx(Xe,{role:o.guardianRole}),o.isRecurring&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-semibold",style:{background:"var(--color-primary-muted)",color:"var(--color-primary)"},children:[e.jsx(xe,{size:11,"aria-hidden":"true"}),"Recorrente semanal"]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[o.status==="PENDENTE"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-gradient flex-1",onClick:()=>{x(null),y("Check-in registrado!","success")},children:"Check-in"}),e.jsx("button",{className:"btn-danger flex-1",onClick:()=>{x(null),y("Falta registrada. Ocorrência gerada automaticamente.","warning")},children:"Registrar falta"})]}),o.status==="CONFIRMADO"&&e.jsx("button",{className:"btn-success flex-1",onClick:()=>{x(null),y("Check-out registrado!","success")},children:"Check-out"}),e.jsx("button",{onClick:()=>x(null),className:"btn-secondary",style:{flex:(o.status==="CONFIRMADO","0 0 auto"),padding:"0 16px"},children:"Fechar"})]})]})]})}),m&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 fade-in",style:{zIndex:"var(--z-modal)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},role:"dialog","aria-modal":"true","aria-labelledby":"new-event-title",children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl overflow-hidden",style:{boxShadow:"0 24px 64px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{className:"p-5 flex items-center justify-between",style:{background:"var(--foursys-gradient)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},"aria-hidden":"true",children:e.jsx(L,{size:20,color:"#fff"})}),e.jsx("h3",{id:"new-event-title",className:"text-lg font-bold text-white",children:"Novo evento"})]}),e.jsx("button",{onClick:()=>i(!1),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},"aria-label":"Fechar",children:e.jsx(A,{size:16,"aria-hidden":"true"})})]}),e.jsx("div",{className:"p-5",style:{background:"var(--color-surface)"},children:e.jsxs("form",{onSubmit:a=>{a.preventDefault(),i(!1),y("Evento criado com sucesso!","success")},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-label block mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Filho"}),e.jsx("select",{className:"input-field",children:E.map(a=>e.jsx("option",{value:a.id,children:a.fullName},a.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-label block mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Tipo de evento"}),e.jsxs("select",{className:"input-field",children:[e.jsx("option",{value:"VISITA",children:"Visita presencial"}),e.jsx("option",{value:"CONVIVENCIA",children:"Convivência prolongada"}),e.jsx("option",{value:"EVENTO",children:"Evento especial"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-label block mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Início"}),e.jsx("input",{type:"datetime-local",className:"input-field text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-label block mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Fim"}),e.jsx("input",{type:"datetime-local",className:"input-field text-sm",required:!0})]})]}),e.jsxs("label",{className:"flex items-center gap-2.5 cursor-pointer p-3 rounded-xl",style:{background:"var(--color-surface-alt)"},children:[e.jsx("input",{type:"checkbox",className:"rounded"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--color-text-primary)"},children:"Recorrente semanal"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:"Repete toda semana no mesmo dia"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-1",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"btn-secondary flex-1",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-gradient flex-1",children:"Criar evento"})]})]})})]})}),g&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 fade-in",style:{zIndex:"var(--z-modal)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},role:"dialog","aria-modal":"true","aria-labelledby":"modal-swap-title",children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl overflow-hidden",style:{boxShadow:"0 24px 64px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{className:"p-5 flex items-center justify-between",style:{background:"linear-gradient(135deg, #0ea5e9, #7c3aed)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},"aria-hidden":"true",children:e.jsx(T,{size:20,color:"#fff"})}),e.jsx("h3",{id:"modal-swap-title",className:"text-lg font-bold text-white",children:"Solicitar Troca de Dia"})]}),e.jsx("button",{onClick:()=>N(!1),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},"aria-label":"Fechar",children:e.jsx(A,{size:16,"aria-hidden":"true"})})]}),e.jsxs("div",{className:"p-5 space-y-4",style:{background:"var(--color-surface)"},children:[e.jsx("div",{className:"p-3 rounded-xl",style:{background:"rgba(14,165,233,0.07)",border:"1px solid rgba(14,165,233,0.2)"},children:e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"A solicitação de troca será enviada ao co-guardião para aprovação. Ambas as datas ficam bloqueadas até a resposta."})}),e.jsxs("form",{onSubmit:a=>{a.preventDefault();const r={id:`swap-${Date.now()}`,childId:j,requesterId:"user-1",requesterName:"Maria Silva",originalDate:a.currentTarget.originalDate.value,proposedDate:a.currentTarget.proposedDate.value,reason:a.currentTarget.reason.value,status:"PENDENTE",createdAt:new Date().toISOString()};G(l=>[r,...l]),N(!1),y("Solicitação de troca enviada! O co-guardião será notificado.","success")},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Filho"}),e.jsx("select",{className:"input-field",children:E.map(a=>e.jsx("option",{value:a.id,children:a.fullName},a.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Data original *"}),e.jsx("input",{name:"originalDate",type:"date",className:"input-field",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Nova data proposta *"}),e.jsx("input",{name:"proposedDate",type:"date",className:"input-field",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Motivo da solicitação *"}),e.jsx("textarea",{name:"reason",className:"input-field resize-none",rows:3,placeholder:"Explique o motivo da troca...",required:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-1",children:[e.jsx("button",{type:"button",onClick:()=>N(!1),className:"btn-secondary flex-1",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-gradient flex-1",children:"Enviar solicitação"})]})]})]})]})}),k&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 fade-in",style:{zIndex:"var(--z-modal)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},role:"dialog","aria-modal":"true","aria-label":"Solicitações de troca",children:e.jsxs("div",{className:"w-full max-w-lg rounded-2xl overflow-hidden",style:{boxShadow:"0 24px 64px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{className:"p-5 flex items-center justify-between",style:{background:"linear-gradient(135deg, #0ea5e9, #7c3aed)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},"aria-hidden":"true",children:e.jsx(T,{size:20,color:"#fff"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Solicitações de Troca"}),z>0&&e.jsxs("p",{className:"text-xs",style:{color:"rgba(255,255,255,0.7)"},children:[z," pendente(s)"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>{V(!1),N(!0)},className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-bold",style:{background:"rgba(255,255,255,0.18)",color:"#fff",border:"1.5px solid rgba(255,255,255,0.35)"},children:[e.jsx(L,{size:13})," Nova"]}),e.jsx("button",{onClick:()=>V(!1),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},"aria-label":"Fechar",children:e.jsx(A,{size:16,"aria-hidden":"true"})})]})]}),e.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-3",style:{background:"var(--color-surface)"},children:q.length===0?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx(T,{size:28,className:"mx-auto mb-2",style:{color:"var(--color-text-tertiary)"},"aria-hidden":"true"}),e.jsx("p",{className:"text-sm",style:{color:"var(--color-text-tertiary)"},children:"Nenhuma solicitação de troca"})]}):q.map(a=>{const l={PENDENTE:{bg:"var(--color-pendente-bg)",text:"var(--color-pendente)"},ACEITO:{bg:"var(--color-confirmado-bg)",text:"var(--color-confirmado)"},REJEITADO:{bg:"var(--color-cancelado-bg)",text:"var(--color-cancelado)"},CANCELADO:{bg:"var(--color-surface-alt)",text:"var(--color-text-tertiary)"}}[a.status],h=a.requesterId!=="user-1";return e.jsxs("div",{className:"p-3.5 rounded-xl",style:{background:"var(--color-surface-alt)",border:"1px solid var(--color-border)",borderLeft:`4px solid ${l.text}`},children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1.5",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold",style:{color:"var(--color-text-primary)"},children:[d(new Date(a.originalDate),"dd/MM/yyyy",{locale:v})," ",e.jsx(T,{size:12,className:"inline","aria-hidden":"true"})," ",d(new Date(a.proposedDate),"dd/MM/yyyy",{locale:v})]}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:"var(--color-text-tertiary)"},children:h?`Solicitado por ${a.requesterName}`:"Sua solicitação"})]}),e.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full flex-shrink-0",style:{background:l.bg,color:l.text},children:a.status==="PENDENTE"?"Pendente":a.status==="ACEITO"?"Aceito":a.status==="REJEITADO"?"Rejeitado":"Cancelado"})]}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:a.reason}),a.responseNote&&e.jsxs("p",{className:"text-xs mt-1 italic",style:{color:"var(--color-text-tertiary)"},children:['Resposta: "',a.responseNote,'"']}),a.status==="PENDENTE"&&h&&e.jsxs("div",{className:"flex gap-2 mt-2.5 pt-2.5",style:{borderTop:"1px solid var(--color-border)"},children:[e.jsxs("button",{className:"flex items-center justify-center gap-1.5 flex-1 py-1.5 rounded-xl text-xs font-semibold",style:{background:"var(--color-confirmado-bg)",color:"var(--color-confirmado)",border:"1px solid var(--color-confirmado-border)"},onClick:()=>{G(t=>t.map(b=>b.id===a.id?{...b,status:"ACEITO",respondedAt:new Date().toISOString()}:b)),y("Troca aceita! Calendário atualizado.","success")},children:[e.jsx(oe,{size:13,"aria-hidden":"true"})," Aceitar"]}),e.jsxs("button",{className:"flex items-center justify-center gap-1.5 flex-1 py-1.5 rounded-xl text-xs font-semibold",style:{background:"var(--color-cancelado-bg)",color:"var(--color-cancelado)",border:"1px solid var(--color-cancelado-border)"},onClick:()=>{G(t=>t.map(b=>b.id===a.id?{...b,status:"REJEITADO",respondedAt:new Date().toISOString()}:b)),y("Troca recusada.","warning")},children:[e.jsx(ge,{size:13,"aria-hidden":"true"})," Recusar"]})]})]},a.id)})})]})}),je&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 fade-in",style:{zIndex:"var(--z-modal)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},role:"dialog","aria-modal":"true","aria-labelledby":"modal-special-title",children:e.jsxs("div",{className:"w-full max-w-lg rounded-2xl overflow-auto",style:{boxShadow:"0 24px 64px rgba(0,0,0,0.25)",maxHeight:"90vh"},children:[e.jsxs("div",{className:"p-5 flex items-center justify-between sticky top-0 z-10",style:{background:"linear-gradient(135deg, #d97706, #f59e0b)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},"aria-hidden":"true",children:e.jsx(Q,{size:18,color:"#fff"})}),e.jsx("h3",{id:"modal-special-title",className:"text-lg font-bold text-white",children:"Datas Especiais"})]}),e.jsx("button",{onClick:()=>B(!1),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},"aria-label":"Fechar",children:e.jsx(A,{size:16})})]}),e.jsxs("div",{className:"p-5 space-y-4",style:{background:"var(--color-surface)"},children:[e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-xl",style:{background:"rgba(245,158,11,0.08)",border:"1px solid rgba(245,158,11,0.2)"},children:[e.jsx(ie,{size:14,style:{color:"#d97706"},"aria-hidden":"true"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Datas marcadas com ★ no calendário. Feriados e férias podem suspender ou alterar o cronograma de visitas."})]}),R.length===0?e.jsx("p",{className:"text-sm text-center py-4",style:{color:"var(--color-text-tertiary)"},children:"Nenhuma data especial cadastrada"}):e.jsx("div",{className:"space-y-2",children:R.map(a=>{const l={FERIADO:{label:"Feriado",color:"#dc2626"},FERIAS:{label:"Férias",color:"#7c3aed"},DATA_ESPECIAL:{label:"Data especial",color:"#d97706"},ANIVERSARIO:{label:"Aniversário",color:"#059669"}}[a.type]??{label:a.type,color:"#6b7280"};return e.jsx("div",{className:"p-3.5 rounded-xl",style:{background:"var(--color-surface-alt)",border:"1px solid var(--color-border)",borderLeft:`4px solid ${l.color}`},children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--color-text-primary)"},children:a.title}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-semibold",style:{background:`${l.color}15`,color:l.color},children:l.label}),a.recurring&&e.jsx(Ke,{size:11,style:{color:"var(--color-text-tertiary)"},"aria-label":"Recorrente"})]}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:"var(--color-text-tertiary)"},children:a.startDate===a.endDate?d(u(a.startDate),"dd/MM/yyyy",{locale:v}):`${d(u(a.startDate),"dd/MM",{locale:v})} até ${d(u(a.endDate),"dd/MM/yyyy",{locale:v})}`}),a.notes&&e.jsx("p",{className:"text-xs mt-0.5 italic",style:{color:"var(--color-text-tertiary)"},children:a.notes})]}),e.jsx("button",{onClick:()=>X(h=>h.filter(t=>t.id!==a.id)),className:"w-7 h-7 rounded-lg flex items-center justify-center flex-shrink-0",style:{color:"var(--color-cancelado)",background:"var(--color-cancelado-bg)"},"aria-label":`Remover ${a.title}`,children:e.jsx(ca,{size:12})})]})},a.id)})}),e.jsxs("div",{style:{borderTop:"1px solid var(--color-border)",paddingTop:12},children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest mb-3",style:{color:"var(--color-text-tertiary)"},children:"Adicionar nova data"}),e.jsxs("form",{onSubmit:a=>{a.preventDefault();const r=new FormData(a.currentTarget),l={id:`sd-${Date.now()}`,type:r.get("type"),title:r.get("title"),startDate:r.get("startDate"),endDate:r.get("endDate")||r.get("startDate"),recurring:r.get("recurring")==="on",affectsSchedule:r.get("affects")==="on",notes:r.get("notes"),childIds:[j]};X(h=>[...h,l]),a.target.reset(),y("Data especial adicionada!","success")},className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"var(--color-text-secondary)"},children:"Tipo *"}),e.jsxs("select",{name:"type",className:"input-field text-sm",required:!0,children:[e.jsx("option",{value:"FERIADO",children:"Feriado"}),e.jsx("option",{value:"FERIAS",children:"Férias"}),e.jsx("option",{value:"DATA_ESPECIAL",children:"Data especial"}),e.jsx("option",{value:"ANIVERSARIO",children:"Aniversário"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"var(--color-text-secondary)"},children:"Título *"}),e.jsx("input",{name:"title",type:"text",className:"input-field text-sm",placeholder:"Ex: Natal 2026",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"var(--color-text-secondary)"},children:"Data início *"}),e.jsx("input",{name:"startDate",type:"date",className:"input-field text-sm",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"var(--color-text-secondary)"},children:"Data fim"}),e.jsx("input",{name:"endDate",type:"date",className:"input-field text-sm"})]})]}),e.jsx("input",{name:"notes",type:"text",className:"input-field text-sm",placeholder:"Observações sobre esta data..."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{name:"recurring",type:"checkbox",className:"rounded"}),e.jsx("span",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Recorrente anualmente"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{name:"affects",type:"checkbox",className:"rounded"}),e.jsx("span",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"Afeta cronograma"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>B(!1),className:"btn-secondary flex-1",children:"Fechar"}),e.jsx("button",{type:"submit",className:"btn-gradient flex-1",children:"Adicionar"})]})]})]})]})]})}),Ne&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 fade-in",style:{zIndex:"var(--z-modal)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},role:"dialog","aria-modal":"true","aria-labelledby":"modal-rec-title",children:e.jsxs("div",{className:"w-full max-w-lg rounded-2xl overflow-auto",style:{boxShadow:"0 24px 64px rgba(0,0,0,0.25)",maxHeight:"90vh"},children:[e.jsxs("div",{className:"p-5 flex items-center justify-between",style:{background:"linear-gradient(135deg, #1d4ed8, #7c3aed)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},"aria-hidden":"true",children:e.jsx(J,{size:18,color:"#fff"})}),e.jsx("h3",{id:"modal-rec-title",className:"text-lg font-bold text-white",children:"Configurar Recorrência"})]}),e.jsx("button",{onClick:()=>M(!1),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},"aria-label":"Fechar",children:e.jsx(A,{size:16})})]}),e.jsxs("div",{className:"p-5 space-y-4",style:{background:"var(--color-surface)"},children:[e.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-xl",style:{background:"rgba(29,78,216,0.06)",border:"1px solid rgba(29,78,216,0.15)"},children:[e.jsx(ie,{size:14,style:{color:"var(--color-primary)",flexShrink:0,marginTop:1},"aria-hidden":"true"}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"A recorrência define automaticamente quais semanas cada guardião tem a criança, eliminando a necessidade de criar eventos individuais."})]}),ke.filter(a=>a.childId===j).map(a=>e.jsxs("div",{className:"p-4 rounded-xl",style:{background:"var(--color-surface-alt)",border:"1px solid var(--color-border)"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-bold",style:{color:"var(--color-text-primary)"},children:["Configuração Atual: ",e.jsx("span",{style:{color:"var(--color-primary)"},children:a.pattern==="QUINZENAL"?"Quinzenal":a.pattern==="SEMANAL"?"Semanal":a.pattern==="MENSAL"?"Mensal":"Personalizado"})]}),e.jsxs("p",{className:"text-xs mt-0.5",style:{color:"var(--color-text-tertiary)"},children:["Vigente desde ",d(u(a.startDate),"dd/MM/yyyy",{locale:v})]})]}),e.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-bold",style:{background:a.active?"var(--color-confirmado-bg)":"var(--color-cancelado-bg)",color:a.active?"var(--color-confirmado)":"var(--color-cancelado)"},children:[a.active?e.jsx(oe,{size:10}):e.jsx(A,{size:10}),a.active?"Ativo":"Inativo"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"p-2.5 rounded-xl",style:{background:"var(--color-guardian-a-bg)"},children:[e.jsx("p",{className:"text-xs font-semibold",style:{color:"var(--color-guardian-a)"},children:"Guardião A"}),e.jsxs("p",{className:"text-sm font-bold mt-0.5",style:{color:"var(--color-guardian-a)"},children:["Semanas ",a.guardian1Weeks==="PAR"?"Pares":a.guardian1Weeks==="IMPAR"?"Ímpares":"Todas"]})]}),e.jsxs("div",{className:"p-2.5 rounded-xl",style:{background:"var(--color-guardian-b-bg)"},children:[e.jsx("p",{className:"text-xs font-semibold",style:{color:"var(--color-guardian-b)"},children:"Guardião B"}),e.jsxs("p",{className:"text-sm font-bold mt-0.5",style:{color:"var(--color-guardian-b)"},children:["Semanas ",a.guardian2Weeks==="PAR"?"Pares":a.guardian2Weeks==="IMPAR"?"Ímpares":"Todas"]})]})]}),e.jsx("button",{onClick:()=>{ee(r=>r.map(l=>l.id===a.id?{...l,active:!l.active}:l)),y(a.active?"Recorrência pausada.":"Recorrência reativada!",a.active?"warning":"success")},className:"mt-3 text-xs font-semibold",style:{color:a.active?"var(--color-cancelado)":"var(--color-confirmado)"},children:a.active?"⏸ Pausar recorrência":"▶ Reativar recorrência"})]},a.id)),e.jsxs("div",{style:{borderTop:"1px solid var(--color-border)",paddingTop:12},children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest mb-3",style:{color:"var(--color-text-tertiary)"},children:"Nova configuração"}),e.jsxs("form",{onSubmit:a=>{a.preventDefault();const r=new FormData(a.currentTarget),l={id:`rec-${Date.now()}`,childId:j,pattern:r.get("pattern"),guardian1Weeks:r.get("g1weeks"),guardian2Weeks:r.get("g2weeks"),startDate:r.get("startDate"),active:!0};ee(h=>h.filter(t=>t.childId!==j).concat(l)),y("Recorrência configurada! Eventos gerados automaticamente.","success"),M(!1)},className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"var(--color-text-secondary)"},children:"Padrão *"}),e.jsxs("select",{name:"pattern",className:"input-field",defaultValue:"QUINZENAL",required:!0,children:[e.jsx("option",{value:"SEMANAL",children:"Semanal (fins de semana alternados)"}),e.jsx("option",{value:"QUINZENAL",children:"Quinzenal (semanas alternadas)"}),e.jsx("option",{value:"MENSAL",children:"Mensal (1 semana por mês)"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"var(--color-guardian-a)"},children:"Guardião A — semanas *"}),e.jsxs("select",{name:"g1weeks",className:"input-field",defaultValue:"PAR",required:!0,children:[e.jsx("option",{value:"PAR",children:"Pares"}),e.jsx("option",{value:"IMPAR",children:"Ímpares"}),e.jsx("option",{value:"TODAS",children:"Todas"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"var(--color-guardian-b)"},children:"Guardião B — semanas *"}),e.jsxs("select",{name:"g2weeks",className:"input-field",defaultValue:"IMPAR",required:!0,children:[e.jsx("option",{value:"PAR",children:"Pares"}),e.jsx("option",{value:"IMPAR",children:"Ímpares"}),e.jsx("option",{value:"TODAS",children:"Todas"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold mb-1",style:{color:"var(--color-text-secondary)"},children:"Data de início *"}),e.jsx("input",{name:"startDate",type:"date",className:"input-field",required:!0,defaultValue:d(new Date,"yyyy-MM-dd")})]}),e.jsxs("div",{className:"flex gap-3 pt-1",children:[e.jsx("button",{type:"button",onClick:()=>M(!1),className:"btn-secondary flex-1",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"btn-gradient flex-1 flex items-center justify-center gap-1.5",children:[e.jsx(J,{size:14}),"Aplicar"]})]})]})]})]})]})})]})}export{za as default};
