import{c as P,r as m,y as M,i as D,j as e,E as y,S as T,M as b,o as p,d as F,X as w,w as g,n as V}from"./index-DduWlyHt.js";import{U as A}from"./user-plus-CTbmHoEh.js";import{P as $}from"./phone-JWb-0SsZ.js";import{B as I}from"./ban-BXRknzuR.js";import{C as B}from"./circle-alert-D4zJIj6G.js";import{E as U}from"./eye-CONcyIQe.js";import{f,p as h}from"./pt-BR-Cb6bWWUC.js";import{p as v}from"./parseISO-BYvTlcex.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=P("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),u={ADVOGADO:{label:"Advogado(a)",icon:e.jsx(y,{size:14}),color:"#7c3aed"},PSICOLOGO:{label:"Psicólogo(a)",icon:e.jsx(C,{size:14}),color:"#0ea5e9"},ASSISTENTE_SOCIAL:{label:"Assistente Social",icon:e.jsx(T,{size:14}),color:"#059669"},MEDIADOR:{label:"Mediador(a)",icon:e.jsx(U,{size:14}),color:"#d97706"},OUTRO:{label:"Outro",icon:e.jsx(C,{size:14}),color:"#6b7280"}},j={LEITURA:"Leitura geral",LEITURA_CHAT:"Chat (somente leitura)",LEITURA_FINANCEIRO:"Financeiro (somente leitura)",RELATORIOS:"Relatórios e exportação",TOTAL:"Acesso total"},z={ATIVO:{label:"Ativo",bg:"var(--color-confirmado-bg)",text:"var(--color-confirmado)",icon:e.jsx(g,{size:12})},PENDENTE:{label:"Pendente",bg:"var(--color-pendente-bg)",text:"var(--color-pendente)",icon:e.jsx(V,{size:12})},INATIVO:{label:"Inativo",bg:"var(--color-cancelado-bg)",text:"var(--color-cancelado)",icon:e.jsx(I,{size:12})}};function W(){const[n,N]=m.useState(M),[O,i]=m.useState(!1),[r,c]=m.useState(null),[d,E]=m.useState("ALL"),{toast:x}=D(),k=n.filter(s=>d==="ALL"||s.role===d),S=s=>{N(l=>l.map(a=>a.id===s?{...a,status:"INATIVO"}:a)),c(null),x("Acesso revogado com sucesso.","warning")},R=s=>{N(l=>l.map(a=>a.id===s?{...a,status:"ATIVO"}:a)),x("Acesso reativado.","success")};return e.jsxs("div",{className:"max-w-5xl mx-auto space-y-5",children:[e.jsxs("div",{className:"rounded-2xl overflow-hidden",style:{background:"linear-gradient(135deg, #7c3aed 0%, #1d4ed8 100%)",boxShadow:"0 6px 24px rgba(124,58,237,0.28)"},children:[e.jsxs("div",{className:"flex items-center justify-between px-5 pt-5 pb-4 flex-wrap gap-3",style:{borderBottom:"1px solid rgba(255,255,255,0.12)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},"aria-hidden":"true",children:e.jsx(y,{size:20,color:"#fff"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-extrabold text-white leading-tight",children:"Terceiros Autorizados"}),e.jsx("p",{className:"text-xs",style:{color:"rgba(255,255,255,0.7)"},children:"Advogados, psicólogos, mediadores e assistentes com acesso controlado"})]})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-bold transition-all",style:{background:"rgba(255,255,255,0.18)",color:"#fff",border:"1.5px solid rgba(255,255,255,0.35)"},children:[e.jsx(A,{size:14,"aria-hidden":"true"}),"Convidar profissional"]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-px px-5 py-4 text-white",children:[{label:"Ativos",value:n.filter(s=>s.status==="ATIVO").length},{label:"Pendentes",value:n.filter(s=>s.status==="PENDENTE").length},{label:"Redes",value:[...new Set(n.flatMap(s=>s.linkedChildIds))].length}].map(s=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-extrabold leading-none",children:s.value}),e.jsx("p",{className:"text-xs mt-0.5",style:{color:"rgba(255,255,255,0.65)"},children:s.label})]},s.label))})]}),e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-xl",style:{background:"rgba(124,58,237,0.06)",border:"1px solid rgba(124,58,237,0.2)"},role:"note",children:[e.jsx(T,{size:16,style:{color:"var(--color-primary)",flexShrink:0,marginTop:1},"aria-hidden":"true"}),e.jsxs("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:["Todos os acessos de terceiros são registrados em ",e.jsx("strong",{children:"log de auditoria imutável"}),". O profissional tem acesso somente de leitura às informações autorizadas, sem capacidade de edição ou exclusão. O consentimento de ambos os guardiões é necessário para acesso completo."]})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:[["ALL","Todos"],...Object.entries(u).map(([s,l])=>[s,l.label])].map(([s,l])=>e.jsx("button",{onClick:()=>E(s),className:"px-3 py-1.5 rounded-full text-xs font-semibold transition-all",style:{background:d===s?"var(--color-primary)":"var(--color-surface-alt)",color:d===s?"#fff":"var(--color-text-secondary)",border:d===s?"none":"1px solid var(--color-border)"},children:l},s))}),k.length===0?e.jsxs("div",{className:"rounded-2xl p-10 text-center",style:{background:"var(--color-surface-alt)",border:"1px dashed var(--color-border-dark)"},children:[e.jsx(y,{size:32,className:"mx-auto mb-3",style:{color:"var(--color-text-tertiary)"},"aria-hidden":"true"}),e.jsx("p",{className:"text-sm font-semibold",style:{color:"var(--color-text-tertiary)"},children:"Nenhum profissional cadastrado"}),e.jsx("button",{onClick:()=>i(!0),className:"mt-3 text-sm font-bold",style:{color:"var(--color-primary)"},children:"+ Convidar primeiro profissional"})]}):e.jsx("div",{className:"space-y-3",children:k.map(s=>{const l=u[s.role],a=z[s.status];return e.jsxs("div",{className:"p-4 rounded-xl cursor-pointer transition-all",style:{background:"var(--color-surface)",border:"1px solid var(--color-border)",boxShadow:"var(--shadow-soft)",borderLeft:`4px solid ${l.color}`},onClick:()=>c(s),role:"button",tabIndex:0,onKeyDown:o=>{o.key==="Enter"&&c(s)},"aria-label":`${s.name} — ${l.label}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center font-bold text-white text-lg flex-shrink-0",style:{background:`linear-gradient(135deg, ${l.color}, ${l.color}99)`},"aria-hidden":"true",children:s.name.charAt(0)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("p",{className:"text-sm font-bold",style:{color:"var(--color-text-primary)"},children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold",style:{background:`${l.color}15`,color:l.color},children:[l.icon,l.label]}),s.oabNumber&&e.jsx("span",{className:"text-xs font-mono",style:{color:"var(--color-text-tertiary)"},children:s.oabNumber})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1 flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1 text-xs",style:{color:"var(--color-text-tertiary)"},children:[e.jsx(b,{size:11,"aria-hidden":"true"}),s.email]}),s.phone&&e.jsxs("span",{className:"flex items-center gap-1 text-xs",style:{color:"var(--color-text-tertiary)"},children:[e.jsx($,{size:11,"aria-hidden":"true"}),s.phone]})]}),e.jsx("div",{className:"flex items-center gap-1 mt-1.5 flex-wrap",children:s.linkedChildIds.map(o=>{const t=p.find(L=>L.id===o);return t?e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium",style:{background:"var(--color-surface-alt)",color:"var(--color-text-secondary)",border:"1px solid var(--color-border)"},children:t.fullName.split(" ")[0]},o):null})})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2 flex-shrink-0",children:[e.jsxs("span",{className:"flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-semibold",style:{background:a.bg,color:a.text},children:[a.icon,a.label]}),s.acceptedAt&&e.jsxs("span",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:["Desde ",f(v(s.acceptedAt),"dd/MM/yyyy",{locale:h})]}),e.jsx(F,{size:16,style:{color:"var(--color-text-tertiary)"},"aria-hidden":"true"})]})]}),e.jsx("div",{className:"flex gap-1.5 flex-wrap mt-2.5 pt-2.5",style:{borderTop:"1px solid var(--color-border)"},children:s.accessLevel.map(o=>e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium",style:{background:"var(--color-surface-alt)",color:"var(--color-text-secondary)",border:"1px solid var(--color-border)"},children:j[o]},o))})]},s.id)})}),r&&(()=>{const s=u[r.role],l=z[r.status];return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 fade-in",style:{zIndex:"var(--z-modal)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"w-full max-w-lg rounded-2xl overflow-hidden",style:{boxShadow:"0 24px 64px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{className:"p-5 flex items-center justify-between",style:{background:`linear-gradient(135deg, ${s.color}, ${s.color}99)`},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center font-bold text-white text-xl",style:{background:"rgba(255,255,255,0.2)"},"aria-hidden":"true",children:r.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:r.name}),e.jsxs("p",{className:"text-xs",style:{color:"rgba(255,255,255,0.75)"},children:[s.label," · ",r.oabNumber??r.email]})]})]}),e.jsx("button",{onClick:()=>c(null),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},"aria-label":"Fechar",children:e.jsx(w,{size:16})})]}),e.jsxs("div",{className:"p-5 space-y-4",style:{background:"var(--color-surface)"},children:[e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{label:"E-mail",value:r.email},{label:"Telefone",value:r.phone??"—"},{label:"Status",value:l.label},{label:"Convidado em",value:f(v(r.invitedAt),"dd/MM/yyyy",{locale:h})},r.acceptedAt?{label:"Aceito em",value:f(v(r.acceptedAt),"dd/MM/yyyy",{locale:h})}:null].filter(Boolean).map((a,o)=>a&&e.jsxs("div",{className:"p-2.5 rounded-xl",style:{background:"var(--color-surface-alt)"},children:[e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-tertiary)"},children:a.label}),e.jsx("p",{className:"text-sm font-semibold mt-0.5",style:{color:"var(--color-text-primary)"},children:a.value})]},o))}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest mb-2",style:{color:"var(--color-text-tertiary)"},children:"Permissões de acesso"}),e.jsx("div",{className:"space-y-1.5",children:Object.entries(j).map(([a,o])=>{const t=r.accessLevel.includes(a);return e.jsxs("div",{className:"flex items-center gap-2.5 p-2 rounded-lg",style:{background:"var(--color-surface-alt)"},children:[e.jsx("div",{className:"w-5 h-5 rounded flex items-center justify-center flex-shrink-0",style:{background:t?"var(--color-confirmado-bg)":"var(--color-border)",color:t?"var(--color-confirmado)":"transparent"},"aria-hidden":"true",children:t&&e.jsx(g,{size:12})}),e.jsx("p",{className:"text-xs",style:{color:t?"var(--color-text-primary)":"var(--color-text-tertiary)"},children:o})]},a)})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold uppercase tracking-widest mb-2",style:{color:"var(--color-text-tertiary)"},children:"Filhos vinculados"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:r.linkedChildIds.map(a=>{const o=p.find(t=>t.id===a);return o?e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-semibold",style:{background:"var(--color-primary-muted)",color:"var(--color-primary)"},children:o.fullName},a):null})})]}),e.jsxs("div",{className:"flex gap-3 pt-1",children:[e.jsx("button",{onClick:()=>c(null),className:"btn-secondary flex-1",children:"Fechar"}),r.status==="PENDENTE"&&e.jsxs("button",{onClick:()=>{x(`Convite reenviado para ${r.email}`,"info"),c(null)},className:"btn-secondary flex-1 flex items-center justify-center gap-1.5",children:[e.jsx(b,{size:14}),"Reenviar convite"]}),r.status==="ATIVO"&&e.jsxs("button",{onClick:()=>S(r.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2.5 rounded-xl text-sm font-semibold",style:{background:"var(--color-cancelado-bg)",color:"var(--color-cancelado)",border:"1px solid var(--color-cancelado-border)"},children:[e.jsx(I,{size:14}),"Revogar acesso"]}),r.status==="INATIVO"&&e.jsxs("button",{onClick:()=>{R(r.id),c(null)},className:"flex-1 flex items-center justify-center gap-1.5 py-2.5 rounded-xl text-sm font-semibold",style:{background:"var(--color-confirmado-bg)",color:"var(--color-confirmado)",border:"1px solid var(--color-confirmado-border)"},children:[e.jsx(g,{size:14}),"Reativar acesso"]})]})]})]})})})(),O&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4 fade-in",style:{zIndex:"var(--z-modal)",background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)"},role:"dialog","aria-modal":"true","aria-labelledby":"modal-invite-title",children:e.jsxs("div",{className:"w-full max-w-md rounded-2xl overflow-hidden",style:{boxShadow:"0 24px 64px rgba(0,0,0,0.25)"},children:[e.jsxs("div",{className:"p-5 flex items-center justify-between",style:{background:"linear-gradient(135deg, #7c3aed, #1d4ed8)"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},"aria-hidden":"true",children:e.jsx(A,{size:20,color:"#fff"})}),e.jsx("h3",{id:"modal-invite-title",className:"text-lg font-bold text-white",children:"Convidar Profissional"})]}),e.jsx("button",{onClick:()=>i(!1),className:"w-8 h-8 rounded-full flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},"aria-label":"Fechar",children:e.jsx(w,{size:16})})]}),e.jsxs("div",{className:"p-5 max-h-[80vh] overflow-y-auto",style:{background:"var(--color-surface)"},children:[e.jsxs("div",{className:"p-3 rounded-xl flex items-start gap-2 mb-4",style:{background:"rgba(245,158,11,0.08)",border:"1px solid rgba(245,158,11,0.25)"},children:[e.jsx(B,{size:14,style:{color:"#d97706",flexShrink:0,marginTop:1}}),e.jsx("p",{className:"text-xs",style:{color:"var(--color-text-secondary)"},children:"O profissional receberá um convite por e-mail. Após aceitar, terá acesso somente às informações autorizadas abaixo. Todos os acessos são registrados em auditoria."})]}),e.jsxs("form",{onSubmit:async s=>{s.preventDefault(),await new Promise(l=>setTimeout(l,600)),i(!1),x("Convite enviado com sucesso! O profissional receberá o e-mail em breve.","success")},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Tipo de profissional *"}),e.jsx("select",{className:"input-field",children:Object.entries(u).map(([s,l])=>e.jsx("option",{value:s,children:l.label},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Nome completo *"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Dr(a). Nome Sobrenome",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"E-mail profissional *"}),e.jsx("input",{type:"email",className:"input-field",placeholder:"profissional@exemplo.com.br",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"Telefone"}),e.jsx("input",{type:"tel",className:"input-field",placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--color-text-secondary)"},children:"OAB / CRP / CRESS"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Número de registro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"var(--color-text-secondary)"},children:"Permissões de acesso *"}),e.jsx("div",{className:"space-y-1.5",children:Object.entries(j).map(([s,l])=>e.jsxs("label",{className:"flex items-center gap-2.5 p-2.5 rounded-xl cursor-pointer",style:{background:"var(--color-surface-alt)"},children:[e.jsx("input",{type:"checkbox",defaultChecked:s==="LEITURA",className:"rounded"}),e.jsx("span",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:l})]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",style:{color:"var(--color-text-secondary)"},children:"Filhos que pode acessar *"}),e.jsx("div",{className:"space-y-1.5",children:p.map(s=>e.jsxs("label",{className:"flex items-center gap-2.5 p-2.5 rounded-xl cursor-pointer",style:{background:"var(--color-surface-alt)"},children:[e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"}),e.jsx("span",{className:"text-sm",style:{color:"var(--color-text-secondary)"},children:s.fullName})]},s.id))})]}),e.jsxs("div",{className:"flex gap-3 pt-1",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"btn-secondary flex-1",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"btn-gradient flex-1 flex items-center justify-center gap-1.5",children:[e.jsx(b,{size:14}),"Enviar convite"]})]})]})]})]})})]})}export{W as default};
